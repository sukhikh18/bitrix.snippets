document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".form-main-register");if(e){var t=e.querySelector('[data-role="error-messages"]'),r=e.querySelector('[data-role="success-messages"]'),a=e.querySelector('[data-role="captcha-field"]');a&&(a.querySelector("img"),a.addEventListener("click",(function(e){if("IMG"===e.target.tagName.toUpperCase()){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState){var e=JSON.parse(t.response);200===t.status&&(a.innerHTML=e.CAPTCHA_HTML)}},t.open("GET","./?action=getCaptcha&ajax=1"),t.send()}})));var n=!1;e.addEventListener("submit",(function(o){if(o.preventDefault(),n)return!1;var i,s,c=new XMLHttpRequest;console.log("@todo preloader start"),n=!0,t&&(t.innerHTML=""),c.onreadystatechange=function(){if(4===c.readyState){var o=JSON.parse(c.response);if(200===c.status&&"Y"===o.SUCCESS){r&&(r.innerHTML=o.SUCCESS_MESSAGE);var i=e.querySelector(".form-fields");i&&(i.innerHTML=""),setTimeout((function(){o.BACKURL?window.location.href=o.BACKURL:o.AUTH&&document.location.reload()}),4e3)}else s=o.ERRORS,t&&(t.innerHTML=Object.values(s).join("<br>\n"));n=!1,console.log("@todo preloader stop"),a&&(a.innerHTML=o.CAPTCHA_HTML)}var s},c.open("POST",o.target.getAttribute("action")||"./"),c.send((i=o.target,(s=new FormData(i)).append("ajax",1),s))}));var o=e.querySelector('[type="submit"]');e.querySelector('[name="privacy_accept"]').addEventListener("input",(function(e){e.target.checked?(o.classList.remove("disabled"),o.removeAttribute("disabled")):(o.classList.add("disabled"),o.setAttribute("disabled","true"))})),window.cloneValue=function(t,r){var a=e.querySelector(t),n=e.querySelector(r);a&&n&&(a.addEventListener("keyup",(function(e){n.value=e.target.value})),n.removeAttribute("readonly"))}}}));
